<scxml datamodel="prolog">
  <datamodel>
		<data src="" />
    <data id="father">
      bob, jim.
      bob, john.
    </data>
    <data id="">
      mother(martha, jim).
      mother(martha, john).
    </data>
    <data id="household">
      {
        name: "The Bobsons",
        members: ['bob', 'martha', 'jim', 'john']
      }
    </data>
    <data id="childs">
      <child name="jim" father="bob" />
      <child name="john" father="bob" />
    </data>
  </datamodel>
  <state id="s1">
    <onentry>
      <assign location="">
        retract(father(bob, jim)).
        assert(father(steve, jim)).
        assert(father(bob, jack)).
      </assign>
      <log label="index" expr="listing." />
      <foreach array="father(bob, X)"
               item="child"
               index="index">
        <log label="index" expr="index(X)" />
        <log label="child" expr="child(X)" />
      </foreach>
    </onentry>
    <transition target="s2"
                cond="mother(martha, X), father(bob, X)"/>
  </state>
  <state id="s2">
    <onentry>
      <send type="basichttp"
            targetexpr="ioprocessors(basichttp(location(X)))"
            event="foo">
        <content>
          <p>Snippet of XML</p>
        </content>
      </send>
    </onentry>
    <transition 
      target="idle"
      event="foo"
      cond="member(element('p',_,_), X), event(data(X))" />
  </state>

	<state id="idle">
		<transition event="http.post" target="idle">
			<log expr="listing." />
			<respond status="200" to="event(origin(X))" />
		</transition>
		<transition event="http.post" cond="" target="idle">
			<log expr="listing." />
			<respond status="200" to="event(origin(X))" />
		</transition>
	</state>
	
  <state id="end" final="true" />
</scxml>
